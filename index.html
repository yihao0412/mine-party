<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>è¸©åœ°é›·æ´¾å°éŠæˆ²ï¼ˆéš¨æ©Ÿåœ°é›·ï¼‰</title>

<style>
body {
  font-family: Arial, "Microsoft JhengHei", sans-serif;
  text-align: center;
  background: #f0f8ff;
}
#board {
  display: grid;
  gap: 6px;
  justify-content: center;
  margin-top: 20px;
}
button.cell {
  width: 48px;
  height: 48px;
  font-size: 14px;
  font-weight: bold;
  border-radius: 6px;
  border: none;
  cursor: pointer;
}
.red { background: #ff4d4d; }
.blue { background: #4da6ff; }
.green { background: #4dff88; }
button:disabled { opacity: 0.9; cursor: not-allowed; }
.panel { margin-top: 10px; }
.hidden { display: none; }
h2 { margin-top: 20px; color: #333; }
</style>
</head>

<body>

<h2>ğŸ‰ è¸©åœ°é›·æ´¾å°éŠæˆ²ï¼ˆéš¨æ©Ÿåœ°é›·ï¼‰</h2>
<p>ä¸»æŒäººè¨­å®šæ£‹ç›¤å¤§å°èˆ‡åœ°é›·æ•¸é‡ï¼Œé–‹å§‹éŠæˆ²å¾Œç©å®¶åªèƒ½çœ‹æ£‹ç›¤ï¼</p>

<!-- ä¸»æŒäººè¨­å®šå€ -->
<div id="setup" class="panel">
  æ£‹ç›¤å¤§å°ï¼š
  <input type="number" id="size" value="7" min="3" max="15"><br><br>

  åœ°é›·æ•¸é‡ï¼š
  <input type="number" id="mineCount" value="5" min="1" max="20"><br><br>

  <button onclick="startGame()">ğŸ¬ é–‹å§‹éŠæˆ²</button>
</div>

<!-- ç©å®¶éŠæˆ²å€ -->
<div id="game" class="hidden">
  <div id="board"></div>
</div>

<script>
let size = 7;
let mineSet = new Set();
let used = new Set();

function startGame() {
  size = parseInt(document.getElementById("size").value);
  const mineCount = parseInt(document.getElementById("mineCount").value);

  used.clear();
  mineSet.clear();

  // éš¨æ©Ÿç”Ÿæˆåœ°é›·
  while (mineSet.size < mineCount) {
    const r = Math.floor(Math.random() * size);
    const c = Math.floor(Math.random() * size);
    mineSet.add(`${r},${c}`);
  }

  document.getElementById("setup").classList.add("hidden");
  document.getElementById("game").classList.remove("hidden");

  buildBoard();
}

function buildBoard() {
  const board = document.getElementById("board");
  board.innerHTML = "";
  board.style.gridTemplateColumns = `repeat(${size}, 50px)`;

  for (let i = 0; i < size * size; i++) {
    const btn = document.createElement("button");
    btn.className = "cell";
    btn.textContent = i + 1;
    btn.onclick = () => pick(i);
    board.appendChild(btn);
  }
}

function pick(i) {
  if (used.has(i)) return;
  used.add(i);

  const r = Math.floor(i / size);
  const c = i % size;
  const key = `${r},${c}`;
  const btn = document.getElementsByClassName("cell")[i];

  if (mineSet.has(key)) {
    btn.classList.add("red");
    btn.disabled = true;
    alert("ğŸ‰ ä½ è¸©åˆ°åœ°é›·ï¼Œç²å‹ï¼");
    return;
  }

  const adj = [
    `${r-1},${c}`, `${r+1},${c}`,
    `${r},${c-1}`, `${r},${c+1}`
  ];

  if (adj.some(a => mineSet.has(a))) {
    btn.classList.add("blue");
  } else {
    btn.classList.add("green");
  }

  btn.disabled = true;
}
</script>

</body>
</html>